// Generated by Pnyx Generation tool at :05/04/2009 11:10:21 p.m.
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Condesus.EMS.Business.Security;
using System.Transactions;

namespace Condesus.EMS.Business.CT.Entities
{
    public abstract class Topic
    {
        #region Internal Region
        private Int64 _IdTopic;
        private Int64 _IdForum;
        private Int64 _IdCategory;
        private Int64 _IdPerson;
        private DateTime _PostedDate;
        private String _Title;
        private Int64 _MaxAttachmentSize;
        private Boolean _AllowResponses;
        private Boolean _IsModerated;
        private Credential _Credential;
        
        #endregion

        #region External Region
        internal Credential Credential
        {
            get { return _Credential; }
        }
        public Int64 IdTopic
        {
            get { return _IdTopic; }
        }
        public Category Category
        {
            get { return new Collections.Categories(Credential).Item(_IdCategory); }
        }
        public Int64 IdPerson
        {
            get { return _IdPerson; }
        }
        public DateTime PostedDate
        {
            get { return _PostedDate; }
        }
        public String Title
        {
            get { return _Title; }
        }
        public Int64 MaxAttachmentSize
        {
            get { return _MaxAttachmentSize; }
        }
        public Boolean AllowResponses
        {
            get { return _AllowResponses; }
        }
        public Boolean IsModerated
        {
            get { return _IsModerated; }
        }
        internal abstract void Remove();
        public abstract void ChangeState();
        #endregion

        #region Constructor
        internal Topic(Int64 idTopic, Int64 idForum, Int64 idCategory, Int64 idPerson, DateTime postedDate, String title, Int64 maxAttachmentSize, Boolean allowResponses, Boolean isModerated, Credential credential)
        {
            _IdTopic = idTopic;
            _IdForum = idForum;
            _IdCategory = idCategory;
            _IdPerson = idPerson;
            _PostedDate = postedDate;
            _Title = title;
            _MaxAttachmentSize = maxAttachmentSize;
            _AllowResponses = allowResponses;
            _IsModerated = isModerated;
            _Credential = credential;

        }
        #endregion

        public void Modify(Entities.Category category, String title, Int64 MaxAttachmentSize, Boolean allowResponses, Boolean isModerated)
        {
            using (TransactionScope _transactionScope = new TransactionScope())
            {
                new Collections.Topics(_Credential).Update(this, category, title, MaxAttachmentSize,allowResponses,isModerated);
                _transactionScope.Complete();
            }
        }

    }
}
